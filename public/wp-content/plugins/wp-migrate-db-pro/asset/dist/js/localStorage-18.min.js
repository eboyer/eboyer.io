!function(a,b){a(document).ready(function(){b.functions.localStorage_available=function(){try{return localStorage.setItem("wpmdb_test","wpmdb_test"),localStorage.removeItem("wpmdb_test","wpmdb_test"),!0}catch(a){return!1}},b.functions.maybe_reload_page=function(){var c=wpmdb_migration_type();if(b.functions.localStorage_available()&&"cancelled"!==b.current_migration.status&&!0!==b.common.migration_error&&-1!==a.inArray(c,["pull","import","find_replace"])&&("true"!==wpmdb_data.is_multisite||!a("#mst-select-subsite").is(":checked")||wpmdb_data.this_domain===a("#mst-selected-subsite option:selected").text())){var d=b.functions.get_tables_to_migrate();"import"===c&&(d=b.functions.get_tables_to_import()),-1===a.inArray(wpmdb_data.this_prefix+"options",d)&&-1===a.inArray(wpmdb_data.this_prefix+"usermeta",d)||(b.functions.set_localStorage_form_data(),location.reload())}},b.functions.set_localStorage_form_data=function(){var b={};a.each(a("#migrate-form").serializeArray(),function(a,c){if("[]"===c.name.substr(-2)){var d=c.name.slice(0,-2);"undefined"==typeof b[d]&&(b[d]=[]),b[d].push(c.value)}else b[c.name]=c.value}),localStorage.setItem("wpmdb_migrate_form",JSON.stringify(b))},b.functions.get_localStorage_form_data=function(){var a=localStorage.getItem("wpmdb_migrate_form");if(null===a)return!1;try{a=JSON.parse(a)}catch(a){return!1}return a},b.functions.remove_localStorage_form_data=function(){localStorage.removeItem("wpmdb_migrate_form")},b.functions.load_data_from_localStorage=function(){var c=b.functions.get_localStorage_form_data();c&&(a.each(c,function(c,d){var e=a('[name="'+c+'"]'),f=e.attr("type");"action"===c?(b.migration_selection=d,a("#"+d).prop("checked",!0)):"radio"===f?a('[name="'+c+'"][value="'+d+'"]').prop("checked",!0):"checkbox"===f?(e.prop("checked",!0),e.parent().hasClass("checkbox-label")&&e.parent().next().show()):e.val(d)}),a(".option-group input[type=radio]").change(),a("."+b.migration_selection+"-list ul").show(),a.when(b.functions.connection_box_changed()).done(function(){if("migrate_select"===a("input[name=table_migrate_option]:checked").val()?("undefined"!=typeof c.select_tables&&a("#select-tables").val(c.select_tables),a(".table-options .expandable-content, .select-tables-wrap").show(),a(".table-options .expand-collapse-arrow").removeClass("collapsed")):a(".select-tables-wrap").hide(),"backup_manual_select"===a("input[name=backup_option]:checked").val()&&("undefined"!=typeof c.select_backup&&a("#select-backup").val(c.select_backup),a(".backup-tables-wrap").show()),"undefined"!=typeof c.select_post_types&&(a("#select-post-types").val(c.select_post_types),b.functions.exclude_post_types_warning()),"undefined"!=typeof c.replace_old){a(".replace-row").not(".original-repeatable-field").remove();var d=1;a.each(c.replace_old,function(b,e){a(".replace-row:nth-child("+d+")").length||a(".replace-row").last().after(a(".original-repeatable-field").clone().removeClass("original-repeatable-field")),a(".replace-row:nth-child("+d+') [name="replace_old[]"]').val(e),a(".replace-row:nth-child("+d+') [name="replace_new[]"]').val(c.replace_new[b]),d++})}}),b.functions.update_migrate_button_text(),"import"!==wpmdb_migration_type()&&b.functions.remove_localStorage_form_data())},b.functions.load_data_from_localStorage()})}(jQuery,wpmdb);